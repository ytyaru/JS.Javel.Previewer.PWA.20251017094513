# Javel Viewer file 画面構成

1. 原稿などの入力待ち画面
2. 本画面
3. 設定画面

```
Javel Viewer 小説を読もう！
PWA 1.0.0 AGPL　簡易テキストからHTMLに変換するよ。ページを捲って小説を読もう！

原稿
ページ
```

```
原稿
  ファイルをDnDしても開けるよ！
  [URL           ]
  [ファイルを開く]
  +--------------+
  |              |
  +--------------+
```
```
ページ
```



```html
<header>Javel Viewer</header>
<main></main>
<footer></footer>
```

```html
<div name="header"></div>
<div name="book"></div>
```

## 2. 本画面

* コンテンツ
* フッタ

### 2-1. コンテンツ

* 段組み(1, 2)
* 書字方向(vertical-rl, horizontal-tb)
* 改段組、改ページ
    * 改段組: `break-after`/`break-before`（見出し要素の前後で。h1,h2,h3など連続している場合はまとめて一ページ以内に含めるか一つずつ見開きにするか）
    * ページ区切り部分（page-splitterで`。`,`、`,`「`などを単独にせず前後の文字とくっつけることでページ分断されぬようにする）

### 2-2. フッタ

　フッタは主にノンブル（ページ数）を表示する部分である。他にも作品タイトル、章タイトル、現在時刻を表示する。それらは設定によって表示是非や書式を変更できるものとする。

#### 配置・書字方向

　コンテンツの段数と書字方向によってフッタの配置位置と書字方向が変わる。

　以下の観点で決定する。

* 本に近づける（大抵フッタは本の下にある）
* 画面スペースを有効利用する（余白にフッタ項目を配置する（余白を減らす）本では不可能な場所に配置することも視野に入れる）

書字方向|段数|フッタ書字方向|フッタ配置
--------|----|--------------|----------
H|1|H|下
H|2|V|H中
V|1|H|下
V|2|H|V中

H1
```
０１２３４５
６７８９０１
footer
```

H2
```
０１２３４５　f　０１２３４５
６７８９０１　o　６７８９０１
２３４５６７　o　２３４５６７
８９０１２３　t　８９０１２３
４５６７８９　e　４５６７８９
０１２３４５　r　０１２３４５
```

V1
```
６０
７１
８２
９３
０４
１５
footer
```

V2
```
３０
４１
５２
footer
９６
０７
１８
```

#### 項目

* 現在時刻
* 章タイトル
* ノンブル
* タイトル

##### 現在時刻

* 数
    * 算用数字（アラビア数字）
    * 漢数字
        * 小字
        * 大字（改竄防止のため複雑な字形を使う。実際は「壱、弐、参、拾」の4文字のみを大字にすれば改竄防止できる）
* 単位語（十、百、千、万…）
* ゼロ埋め

　時刻の表示には漢数字の小字だけを使う。大字や単位語は使わないものとする。ゼロ埋めして必ず四桁にする。これにて`:`を省略し、時間と分の区別がつくようにする。

算用|0|1|2|3|4|5|6|7|8|9
----|-|-|-|-|-|-|-|-|-|-|
漢小|一|二|三|四|五|六|七|八|九|十
漢大|壱|弐|参|肆|伍|陸|漆|捌|玖|拾

算用|漢小|漢大|漢旧
----|----|----|----
0|〇|零|-
1|一|壱|壹
2|二|弐|貳
3|三|参|參
4|四|肆|-
5|五|伍|-
6|六|陸|-
7|七|漆|-
8|八|捌|-
9|九|玖|-

語|旧|読み
--|--|----
十|拾|じゅう
百|陌/佰|ひゃく
千|阡|せん
万|萬|まん|
億||おく
兆||ちょう
京||けい
垓||がい
𥝱||じょ
穣||
溝||こう
澗||かん
正||せい
載||さい
極||ごく
恒河沙||ごうがしゃ
阿僧祇||あそうぎ
那由他||なゆた
不可思議||ふかしぎ
無量大数||むりょうたいすう

書字方向|書式
--------|----
`horizontal-tb`|`10:59`

　`vertical-rl`の時は工夫しないとダメ。いくつものパターンがありえる。

表記|補足
----|----
`10:59`|`:`は`text-orientation:mixed;`で横倒しにすべき。
`一〇五九`|必ず四桁にする。自衛隊方式。`ひとまるごーきゅー`と読む。`00:00`は`〇〇〇〇`(まるまるまるまる)。`〇時`(`れーじ`)と読み書きしたい。同じく`10:30`は`十時半`のように短く書ける。但し`時`,`半`を使う表記は読み書きの統一性が失くなってしまう。よって四桁固定のほうが良いと思うが好みの問題。時分の間に`:`を付与するかどうかも要検討。
`一〇:五九`|
`十時五十九分`|

　午前／午後を付与すると冗長になるため、24時間制とする。

　`十`があると短く読みやすい場合もあれば冗長になる場合もある。ぴったり十ならシンプルだが、それ以外では冗長になってしまう。十は使用しないほうが短く表記できる場合が多い。よって十は使用しないものとする。

四桁|漢数字
----|------
〇|零
一〇|十
一一|十一
一二|十二
五九|五十九

　縦書きなら`11`は`一一`より`十一`のほうが判りやすい。桁数がいくつかは後ろの字を読まねば確定しないから。最初に`十`が来た時点で大凡の数が判るため十のほうが嬉しい。でも時刻に関しては四桁固定にするから十などの単位語は使わなくていい。

　それでも気になるのは、同じ漢字が連続することである。`00:00`なら`〇〇〇〇`になるのが冗長。`一一一一`、`二二二二`、`三三`、`四四`、`五五`が起こりうる。

```
一
一
```
```
十
一
```


　一桁の時はゼロ埋めしない十を使う表記のほうが短く書けるかと思いきや同じ。

* `08:05`
* `八時五分`
* `〇八〇五`

　`08:05`でゼロ埋めせず`八五`だけだと`01:25`の時は`一二五`になり`01:25`なのか`12:05`なのか判らない。よってゼロ埋め四桁が最短かつ定形にできる覚えやすく判りやすい表記。

　アラビア数字表記でも縦書きなら以下のパターンがある。縦中横にするかどうかが重要。

```
1
2
:
3
4
```
```
1
2
3
4
```
```
12
:
34
```
```
12
‥
34
```
```
12
34
```

* アラビア数字
* 自衛隊方式
* 漢数字



##### ノンブル


## 3. 設定画面

1. メインボタン
    1. 画面表示
        1. ページング
        2. 再び開く
    2. ファイル出力
        1. Javel原稿
        2. HTML本
2. 原稿入力
3. ページ設定
    * 原稿ファイルの設定を優先
    * [縦書き／横書き]
    * サイズは[ウインドウ/UI入力値]に合わせる
    * [1920]x[1080]
    * 全画面／解除
    * タイポグラフィ
        * ☑おまかせ

### 3. ページ設定

1. ページ生成の時期と量

#### 3-1. ページ生成の時期と量

```
ページ生成の時期と量-----------------------------------------------+
| +--------------------------------------------------------------+ |
| |最初に一括で全ページ生成する                                  | |
| |ページ遷移操作後に一ページ生成する                            | |
| |ページ遷移操作後に一ページ生成し表示後に更に次ページを生成する| |
+ +--------------------------------------------------------------+ |
+------------------------------------------------------------------+
```
```
+------+
|一括▼| 説明文
|定時  |
|分割　|
|追割　|
+------+
一括：最速でファイル生成する方法。最初に一括で全ページ生成する。最初に長大な待機を強いられるが、以降はスムーズで全ページ数も表示可。
定時：割り込まれながら生成する方法。[5]秒毎に一ページずつ生成する。全ページ生成完了までの間[5]秒毎に入力不能時間が発生する。全ページ数の判明は全ページ数*[5]秒後。
分割：最速で閲覧し始める方法。ページ遷移時に一ページずつ生成する。すぐ閲覧可能だが、最後のページを捲るまで全ページ数不明。
追割：遅延を分散する方法。ページ遷移時に一ページずつ生成する。追加で更に一ページ先読みして非表示状態で待機する。

ページ生成中はユーザ操作不能。ページ数が多いほど長大な時間がかかるため、分散して体感時間を減らしたい。いつ、どのくらい不能時間にするか制御するのが本項目。

一括は最初の待機時間が長すぎる。
定時は指定時間毎に入力不能が発生する。全ページ判明時間も長大。
分割はページ遷移アニメ時間もあるため入力不能は気にならないが、全ページ数は最後のページを表示するまで不明。実質表示不能。代わりにTextBlock数による読了率を表示する。

+------+
|一括▼| 説明文
|定時  |   [5]秒毎に生成する
|分割　|   ☑追加で一ページ生成し待機する
+------+

方法|最初|遷移毎|[5]秒毎
----|----|------|-------
一括|巨|０|０
定時|短|０|短
分割|短|短|０

方法|最初|遷移毎|[5]秒毎|全ページ数
----|----|------|-------|----------
一括|巨|０|０|閲覧可能時に確定（分割処理時間）
定時|短|０|短|全ページ読込完了時に確定(全ページ数×[5]秒後)
分割|短|短|０|全ページ遷移後に確定（実質表示不能）

　全ページ数の表示は分割処理完了後に可能となる。このため分割方式だと最後のページを閲覧するまで表示不能であり実質表示不能で役立たず。
　全ページ数を表示する意義は「あと何タップすれば読了するか？」を示すことだ。全体の規模感を測るのに有意義な指標である。本でも厚みから規模を推測できる。それに該当する指標がページ数である。人はゴールの見えない作業に絶望するため事前に規模の把握が必要だ。
　他にも文字数で規模を示すこともできる。こちらは原稿を執筆した時点でメタデータとして表記するため計算不要で迅速に表示できる。
```

